\documentclass[twocolumn]{article}
\usepackage{default}

\addbibresource{references.bib}
\addbibresource{references_phasemapping.bib}
\addbibresource{references_impact_arrhythmia.bib}
\graphicspath{{./figures/}}

\title{An Improved Phase Mapping Implementation using Phase Defects for the Detection of Topologically Charged Boundaries sustaining Cardiac Arrhythmia}
\author[1]{Bjorn Verstraeten}
\author[1]{Sebastiaan Lootens}
\author[1]{Arthur Santos Bezerra}
\author[1]{Viktor Van Nieuwenhuize}
\author[1]{Robin Van Den Abeele}
\author[1]{Sander Hendrickx}
\author[1]{Arstanbek Okenov}
\author[1]{Timur Nezlobinskii}
\author[2]{Balvinder Handa}
\author[2]{Vineesh Kappadan}
\author[2]{Fu Siong Ng}
\author[1]{Nele Vandersickel}
\affil[1]{Department of Physics and Astronomy, Ghent University, Ghent, Belgium}
\affil[2]{Imperial College London, London, United Kingdom}
\date{\today}

\begin{document}

\twocolumn[
  \begin{@twocolumnfalse}
    \maketitle

    \begin{abstract}
      \noindent Rotational activity is one of the mechanisms behind
      cardiac arrhythmias,
      and it is therefore important to accurately localize such activity in
      cardiac tissue. A standard method for this, is called phasemapping.
      While widely used for analyzing rotors in cardiac simulations,
      phasemapping struggles to correctly analyze activation maps with large
      non-conductive regions and/or conductive blocks. To illustrate these, we
      examine a simulation that exhibits these treats, and demonstrate how
      each of them can be addressed.
    \end{abstract}

  \end{@twocolumnfalse}
  \vspace{2em}
]

\section{Introduction}

Atrial fibrillation, the most common cardiac arrhythmia and a major contributor to cardiovascular mortality,
remains difficult to treat effectively due to patient-specific mechanisms,
with rotational electrical activity identified as a key driver \cite{worldbankWorldBank, Brundel2022, 1994theoretical_hypothesis_scrollwaves_fibrillation_winfree}.
Detecting and characterizing such activity has therefore been a central goal in both experimental and clinical electrophysiology.

% I believe it was done for rabbit hearts
In order to detect rotational activity in optical maps of a rabbit heart,
phasemapping was introduced \cite{1995experimental_rabbit_fibrillation_gray}.
Since then, numerous papers were published that uses phasemapping for analyzing different datasets
ranging from simulated functional re-entry \cite{2018simulation_benchmark_wavelength_fibrosis_roney, 2024simulation_benchmark_fibrosis_meandering_noise_lootens}
These studies have demonstrated both the promise of phasemapping
and its limitations when confronted with realistic data.

The identification of phase singularities can be distorted by multiple factors,
% Is it a short cycle lenght or something else?
including short cycle lengths \cite{2018simulation_benchmark_wavelength_fibrosis_roney},
fibrosis \cite{2018simulation_benchmark_wavelength_fibrosis_roney, 2024simulation_benchmark_fibrosis_meandering_noise_lootens},
meandering \cite{2024simulation_benchmark_fibrosis_meandering_noise_lootens},
noise \cite{2024simulation_benchmark_fibrosis_meandering_noise_lootens},
limited spatial resolution \cite{2017clinical_benchmark_resolution_roney},
conduction blocks \cite{2025simulation_benchmark_pm_dgm_hhz_lootens},
and non-conductive tissue \cite{2025simulation_benchmark_pm_dgm_hhz_lootens}.
In particular, conduction blocks, termed phase defects,
have been recognized as equally important as phase singularities \cite{tomii2021spatial, 2021experimental_phasedefect_method_arno}.
Additionally, non-conductive structures play an important part during ablation therapy \cite{duytschaever2024atrial}.
Likewise, non-conductive structures play a critical role,
% Maybe some other citations could be placed here?
especially in the context of ablation therapy \cite{duytschaever2024atrial}.
Together, these features underscore the need to reconsider
how phasemapping algorithms handle such discontinuities in cardiac tissue.

Our central claim is that phasemapping is conceptually sound,
but naive implementations fail when confronted with discontinuities.
To demonstrate this, we compare two algorithmic approaches:
a naive approach that assumes the phase field is smooth,
and an extended approach that explicitly accounts for conduction block and inexcitable regions.

Both approaches are applied to simulated activation patterns to isolate different arising problems,
and to an experimental optical mapping recording of ventricular fibrillation in a rat heart.
Together, these results show
that improper handling of phase defects and non-conductive structures
can lead to misleading interpretations,
while careful treatment restores the reliability of phasemapping.

\subsection{Background}

\subsubsection{Phase Index}

Phasemapping relies on a metric called the phase index,
which is formally defined by

\begin{equation}
  I = \frac{1}{2\pi}\oint_C \nabla \phi \cdot d\bm{l} ,
  \label{eq:phase-index}
\end{equation}

\noindent where $C$ is a closed curve
and $\phi$ is referred to as the phase field.
The phase field $\phi$ can be any scalar field of which the values are periodic,
typically normalized between $0$ and $2\pi$.
As such, the phase index can be used to analyze cardiac activation maps
by recognizing that the state of a cardiac cell changes periodically;
a cell can go from resting state to an excited state,
and after a while it repolarizes back to its resting state \cite{1984theoretical_scrollwaves_chemical_winfree}.

In case the phase field represents the local state of cardiac tissue,
we also require that $\phi$ is smooth and defined across $C$.
These requirements constrain the possible values of the phase index as follows:
First, moving counterclockwise around $C$ changes $\phi(\bm{x})$ continuously.
Next, since $\phi(\bm{x})$ is defined on $C$,
the value of $\phi(\bm{x})$ after crossing the closed curve,
should represent the same state as at the beginning.
Hence, over a closed curve,
$\phi(\bm{x})$ can only change by an integer multiple of $2\pi$.

When the phase field represents the local state of cardiac tissue,
we additionally require that $\phi$ is smooth and defined across $C$.
These conditions constrain the possible values of the phase index:
moving counterclockwise around $C$ changes $\phi(\bm{x})$ continuously,
and since $\phi(\bm{x})$ must return to the same state after the closed curve,
its total change can only be an integer multiple of $2\pi$.
Consequently, the phase index $I$ itself must be an integer,
which can be interpreted as the winding number or topological charge of the phase field around $C$.

Another interesting insight can be found when rewriting Equation~\ref{eq:phase-index}.
Assuming that $\nabla\phi$ is smooth in a region $S$ that is bounded by a curve $C$,
Stokes' theorem can be applied, giving

\begin{equation}
  I = \frac{1}{2\pi} \iint_S \nabla \times (\nabla \phi) \cdot d\bm{S}
  \label{eq:phase-index-stokes}
\end{equation}

\noindent This expression will always be zero,
and thus, the only time that the phase index is different from zero will be when
$\nabla \phi$ is not smooth or if $\phi$ is undefined in some part of $S$ \autocite{herlin2012reconstruction}.
This is exactly the case when a rotor is present in $S$,
since at the rotor tip, the state is undefined.
Additionally, we would like to mention that Equation~\ref{eq:phase-index-stokes}
is used in the kernel implementation of phasemapping found in \textcite{2001theoretical_convolution_method_bray}.

At this point, it should be clear how the phase index can be used to detect rotors.
Nevertheless, we would like to highlight some subtleties in its interpretation.
First, the phase index is a property of a closed curve
and not of a singular point.
Only when there is one singular point inside that curve,
a phase index can be assigned to that point.
Nevertheless, it is perfectly fine to draw a curve around multiple rotor tips
and calculate the phase index.
The phase index of this curve $I_C$ would then be equal to the sum of all singular points inside that curve.

\begin{equation}
  I_C = \sum_{\bm{x}_i\in C} I(\bm{x}_i)
  \label{eq:index-curve}
\end{equation}

Second, it should be mentioned that a non-zero phase index does not necessarily represent rotation of the wavefront.
While it is true that if there is rotational activity,
it is possible to find a curve with a non-zero index,
the phase index only indicates the phase has shifted with a multiple of the period
when travelling across that curve.
To make this statement more concrete,
The results include an activation pattern that is surrounded by a curve with a non-zero index,
but does not show any rotation (See Figure~\ref{fig:zoom-reentry}).

\subsubsection{Phase Defects and Non-conductive Structures}

The requirement that $\phi(\bm{x})$ is smooth and defined across a closed curve
is not trivial.
An obvious example is a curve that crosses a rotor tip,
but cardiac tissue can contain other structures where these requirements are not fulfilled.
As mentioned in \textcite{arno2021a, tomii2021spatial},
cardiac tissue can exhibit discontinuities in its phase field, termed phase defects.
Phase defects can arise when the excitation wavefront hits a region
that is still in refractory,
forming a line where one side is excited and the other side is still repolarizing.
These phase defects present our first problem,
as it is impossible to construct a curve
that encircles only a single point lying on the defect.
The best one can do is to draw a curve around this defect and calculate its phase index.

Another situation where the $\phi$ is not smooth,
can be found in clinical practice.
When a patient has an arrhythmia,
the physician could perform ablation therapy
and burn  certain regions of the tissue.
The cells in these patches of scar have an undefined phase.
While the bulk of these patches don't show interesting behavior,
the boundary still can.
However, just like with phase defects,
the best one can do is to draw a curve around the non-conductive tissue
and calculate its index.

Finally, we should consider the boundaries.
This can be the outer boundaries of a 2D simulation,
or, a more clinical example, the mitral valve and pulmonary veins in the left atrium.
One can see the similarity between a non-conductive patch
and a hole in the tissue.
Therefore, boundaries can be treated similar as non-conductive patches,
which also enables us to capture patterns such as anatomical reentries~\autocite{duytschaever2024atrial}.

An overview on how to adjust the curves when phase defects and boundaries are present
is given in Figure~\ref{fig:index_calculation}.
The first thing that one should notice is
that the curve around the outer boundary is oriented in clockwise direction.
This convention has been proposed in \textcite{davidsen2004topological} to make sure
that the total phase index is conserved for compact surfaces (see Section~\ref{sec:conservation-of-total-phase-index}).
Secondly, phase defects and non-conductive structures, 
are all treated in the same manner.
Therefore, it is only natural to call them all finite cores in case they have a non-zero index.
This naming refers to the finite circumfrence of the smallest curve one can draw,
which distinguishes them from singular cores.
The naming also lays in line with linear cores, which what defects are called in \textcite{arno2021a}
when they have a non-zero index.

\begin{figure}[ht]
  \centering
  \includefig{index_calculation}
  \caption{Example of a bounded planar domain with holes. The domain
    contains singular points at \(\pmb{x}_1\), \ldots, \(\pmb{x}_n\) and
    holes \(H_1\), \ldots{} \(H_{m-1}\), with the outer boundary
    representing the final hole \(H_m\).
    Non-conductive patches are shaded in and considered as a hole.
    Curves are drawn around each singular point and hole
    with the arrow represent the direction of integration.
    In addition, a phase defect $D_k$ is presented
    together with a curve over which to integrate to get the phase index of the defect.
  }
  \label{fig:index_calculation}
\end{figure}

\subsubsection{Conservation of Total Phase Index}\label{sec:conservation-of-total-phase-index}

Let us first start of by looking at a closed surface $S$, meaning no boundaries,
and a phase field that is smooth except in a finite number of singular points $\bm{x}_i$.
If we now draw a curve on that surface with nothing in it,
its phase index will be zero as implied by Equation~\ref{eq:phase-index-stokes}.
Since \(S\) is a closed surface, this curve also encircles everything,
and since Equation~\ref{eq:index-curve} still applies,
we can write

\begin{equation}
  \sum_{x_i \in S} I(x_i) = 0
  \label{eq:index-theorem}
\end{equation}

\noindent This is the same as stating that the sum of all phase indices is
conserved on a closed surface.
This conservation law can be extended to compact surfaces \autocite{herlin2012reconstruction, davidsen2004topological},
resulting in the following equation:

\begin{equation}
  \sum_{x_i \in S} I(x_i) + \sum_{H_j \in S} I(H_j) + \sum_{D_k \in S} I(D_k)  = 0
  \label{eq:index-theorem-extended}
\end{equation}

\noindent where \(x_i\) are the singular points in \(S\),
\(H_j\) the holes,
and \(D_k\) the phase defects.
From now on we will refer to Equation~\ref{eq:index-theorem-extended} as the index theorem.

\vspace{2em}

\noindent Like stated above, the main topic of this paper is about the importance
of handling obstacles and boundaries in cardiac tissue.
The index theorem can be useful for assessing the quality of an analysis,
but it does not give a conclusive answer.
Therefore, in this paper we will try to present a simulation
that contains all pitfalls which are discussed above,
while still being simple enough to visually confirm the correct analysis.

\section{Methods}

First, we describe our four categories of boundaries: (1) scar boundaries, (2) surface boundaries, (3) functional boundaries and (4) hybrid boundaries and four activation pattern types: (1) simple uncharged (2) complex uncharged (3) simple charged (4) complex charged.
Second, we describe the naive implementation of PM and its problems. Third, we introduce our improved implementation of PM that correctly handles boundaries. Fourth, we describe the simulation protocol of the eight simulations. Finally, we present the experimental optical mapping recording of ventricular fibrillation in a rat heart.
\subsection{Definitions: types of boundaries and activation patterns}

% - phase index integral definition and equivalent practical definition using phasejumps
% - Intuition behind idea shift: from phase singularities to boundaries (Stokes theorem)
% - Boundary types: scar, surface, functional, hybrid
% - Topologically uncharged activation patterns: simple (2 wavefronts), complex (4, 6, 8, ... wavefronts)
% - Topologically charged activation patterns: simple (1 wavefront), complex (2, 3, 4, ... wavefronts)

There exists a numerous amount methods to detect rotational activity \autocite{pikunov2023the, gurevich2019robust, li2020standardizing},
making it is near impossible to create a comparative study or full review.
Therefore, we opted to give a demonstration of the effect
that boundaries and phase defect can have on the analysis.
This effect becomes most visible by comparing two approaches.
Both approaches will use a straightforward implementation of phasemapping, but
they will differ in the assumption that where made about the cardiac tissue.
In the first approach, it is naively assumed
that the phase is smooth across the complete tissue.
In the second approach, we account for possible obstacles and boundaries,
and perform a phasemapping analysis afterward.

\subsection{Setup of the Simulation}

As it is not required to have realistic geometries to induce phase
defects, We chose to create a simulation on a homogeneous 2D grid. This
also has the benefit to get a full overview of the simulation at once
and easily place snapshots in the paper.
The simulation is created using Finitewave
(\url{https://github.com/finitewave/Finitewave}), an open-source Python
package for a wide range of tasks in modelling cardiac electrophysiology
using finite-difference methods. The main argument for using Finitewave
is its clear and transparent implementation of the models which allows
us to verify its correctness. Furthermore, the intuitive interface and
lots of examples make it easy to create, evaluate, and adjust
simulations.

The cell model used for the simulation is the Fenton-Karma model. Since
the research question of this paper does not involve the effect of ionic
channels on the dynamics, it is more fitting to use a phenomenological
model which is less computationally heavy and has simpler cell dynamics.
We choose the Fenton-Karma model specifically since it was the easiest
to create phase defects without tweaking the model's parameters.

The 2D mesh is first pre-paced with 10 planar stimuli and an interval of
200 time steps between them. Next, a boundary is added inside the mesh
and a second square stimulus is applied to induce rotational activity.
To ensure that the rotor fits on the mesh, but without increasing
computational time, we lowered the conductivity of the mesh. Finally, we
added a phase defect using a third stimulus in a small region just
before it goes out of refractory.

\subsection{Implementation of phasemapping}

To highlight the influence of phase defects and boundaries, we will
compare two implementations of phasemapping: one where the simulation is
scanned for singularities without addressing phase defects and ignoring
boundaries, which we will refer to as naive phasemapping, and another
were we take into account phase defects and boundaries. This second
implementation is basically an extension of the first one, so we will
refer to it as extended phasemapping.

\subsection{Naive implementation of Phasemapping}
% - Orientation of mesh elements (implicitly done in vtk)
% - Detection of phase singularities using practical definition for mesh elements

The first step was to convert the action potential to a phase field.
This was done using taking the angle Hilbert transform of the action
potential as suggested by \autocite{bray2002considerations}. Additionally,
we made sure that the peak of the action potential corresponds to
\(\pi\) (see Figure~\ref{fig:action_potential_and_phase}),
so that it becomes straightforward to compare the phase field with
the action potential.

\begin{figure}[ht]
  \begin{center}
    \includegraphics[width=\columnwidth]{figures/action_potential_and_phase.png}
  \end{center}
  \caption{
    Time series of the action potential of one cell (orange)
    and the calculated phase (blue).
  }\label{fig:action_potential_and_phase}
\end{figure}

Next, we will create a triangulated mesh and compute the phase index for
each triangle at each time step. In theory, the cells of the mesh could
be any polygon, but triangulated meshes are quite common and choosing
so, made the code simpler.

For any polygon, the phase index can be calculated by counting the
number of phase jumps. An algorithm for this will look like:

\begin{enumerate}
    \def\labelenumi{\arabic{enumi}.}
    \tightlist
  \item
    Compute the phase difference \(\Delta\Phi\) of all edges.
  \item
    Count the number of times \(\Delta\Phi\) is bigger than \(\pi\)
    (positive phase jump).
  \item
    Count the number of times \(\Delta\Phi\) is smaller than \(-\pi\)
    (negative phase jump).
  \item
    Calculate the index with \(I = P - N\) with \(P\) and \(N\) the number
    of positive and negative phase jumps respectively.
\end{enumerate}

\subsection{Improved implementation of PM correctly handling boundaries}
% - Localization of boundaries: scar and functional (model as phase defect, detect using phase difference threshold), surface (vtk methods) + hybrid
% - Orientation of boundaries (implicitly done in vtk)
% - Detection of charged boundaries using practical definition for boundaries
% - Mention computation time complexity

To extend the naive approach, the first thing to do is localizing the
phase defects. Remember that phase defects are defined as
discontinuities in the phase field. In a triangulated mesh this would
manifest as a big phase difference on the edges. Therefore, the most
straightforward thing to do is setting a threshold \(d\) so that an edge
with a phase difference \(\Delta\Phi\) that satisfies
\(d<\Delta\Phi<2\pi-d\) would be considered as a phase defect. We have
found that a value of \(d=0.08\pi\) works best for this simulation, but
keep in mind that this threshold depends highly on the parameters of the
simulation.

Once all phase defects are located, the cells that contain at least one
phase defect are removed. This will create holes in the mesh, allowing
us to treat phase defect and boundaries as the same.

Finally, the boundaries and holes are extracted as polygons. The naive
phasemapping approach (see previous section) is then applied to these
polygons together with the remaining cells.

\subsection{Comparison of both methods}
% - Scar boundaries: experimentally induced ischemia
% - Surface boundaries: 2D image boundary
% - Functional boundaries: fibrillation causes many front-tail interactions
% - Hybrid boundaries: scar + functional, surface + functional + scar
% - Uncharged patterns: functional block + surface boundary + anatomical scar
% - Charged patterns: functional + surface + hybrid boundaries
% - Noise: possible LAT annotations of ischemic cells

\section{Results}

\subsection{Basic simulations}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\columnwidth]{zoom_rotor.png}
  \caption{Zoom of the bottom left of the simulation, showcasing a
    counterclockwise rotation. Left: A snapshot at time step 172, with the
    colors represent the phase of the points at that time step. Rotors and
    critical cycles are annotated in red. Right: The phase density map taken
    across the entire time of the simulation. The colors represent the
    number of time steps that a point was annotated. A log scale was used to
    enhance visibility. The results of the naive approach are displayed at
  the top, and the results of the extended approach the bottom.}
  \label{fig:zoom-rotor}
\end{figure}

First, let's focus on the bottom left (see Figure~\ref{fig:zoom-rotor}).
Both approaches identify rotational activity in this region, and by
comparing both point density maps, it is clear that they also recognize
a similar drift. However, the extended approach detects a phase defect
at the center of the rotational activity, indicating that this is a
linear rotor, while this information is not present in the analysis of
the naive approach.

\begin{figure}[ht]
  \centering
  \includegraphics[width=\columnwidth]{zoom_defect.png}
  \caption{Zoom of the bottom right of the simulation, showcasing a phase
    defect without rotation. From left to right, snapshots are taken at time
    steps 157, 177 and 235. The colors represent the phase of the points at
    that time step. (Counter)clockwise rotation is annotated in red (blue)
    and phase defect without rotation is annotated in white. The results of
    the naive approach are displayed at the top, and the results of the
  extended approach the bottom.}
  \label{fig:zoom-defect}
\end{figure}

Next, we shift focus to the bottom right (see
Figure~\ref{fig:zoom-defect}). Looking at the snapshots of the simulation,
the naive approach highlight two rotors in opposite direction, which
collide with each other before making a complete turn. In contrast, the
extended approach does not identify rotors in this region. Instead, it
finds a phase defect that is located between the two rotors. What
happened here is that the extended approach calculated the phase index
of both rotors together, and since these are of opposite sign, they
cancel each other out.

\begin{figure}[ht]
  \centering
  \includegraphics[width=\columnwidth]{zoom_reentry.png}
  \caption{Zoom of the top of the simulation, showcasing rotation around a
    non-conductive region. Only the results of the extended approach are
    shown, since the naive approach did not detect anything. From left to
    right and top to bottom, snapshots are taken at time steps 132, 172 and
    198. The colors represent the phase of the points at that time step and
  critical cycles with clockwise rotation are annotated in blue.}
  \label{fig:zoom-reentry}
\end{figure}

Finally, we look at the top of the simulation (see
Figure~\ref{fig:zoom-reentry}). We now have the opposite situation as
before at the bottom right: The extended approach finds rotational
activity around the non-conductive tissue while the naive approach does
not. A closer observation of the different snapshots reveals an
interesting pattern: The number of wave fronts around the non-conductive
tissue alternates between one and three. But what makes is even more
peculiar is that none of the wavefronts makes a complete turn. This
reminds us about the pattern seen in the bottom right where two rotors
collide with each other before completing a turn. Yet, this time the
total phase index is non-zero.

\subsection{Case study: optical mapping of experimental rat VF}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\columnwidth]{optical_mapping_results.png}
  \caption{Detections of Naive Phase Mapping (left) and Extended Phase Mapping (right) for an experimental optical mapping recording of rat VF containing several activation patterns and boundary types.}
  \label{fig:optical_mapping_results}
\end{figure}

\section{Discussion}

% Main findings
% - Naive approach violates the index theorem when scar or surface boundaries are present
% - Naive approach dismisses PS that do not make a full rotation which neglects complex charged activation patterns
% - For uncharged functional boundaries: no PS present in extended phase mapping, PS detected by naive approach integrate through phase defects (cite threshold values in Li)

The presented simulation is nothing out of the ordinary.
It has only three main components:
a linear core, rotation around a non-conductive region and a phase defect.
That is it. No anisotropic conductivity, no fibers and no noise.
The simulation is also of a good resolution, which also favors phasemapping.
Yet, the result of the naive approach is quite different
from that of the extended approach.
We argue that the result of the extended approach is more favorable
as it aligns better with our visual inspection.

Additionally, the result of the naive approach does not fulfil the index theorem (Eq.~\ref{eq:index-theorem-extended}),
implying that the analysis is incorrect.
Indeed, the naive approach detects two rotors around the phase defect at the bottom right,
but there is no rotation present at that location.
Some people would dismiss these rotors tips
by stating that they do not make a full rotation,
but this argument would also dismiss the near-complete rotation
found around the scar tissue.
However, recent clinical studies indicate
that this pattern plays a critical role in atrial tachycardia~\autocite{duytschaever2024atrial, santucci2024identification, takigawa2019a}.
Its significance can be explained by the index theorem (Eq.~\ref{eq:index-theorem-extended}).
Because the sum of all indices is always zero,
one could hypothesize that ablation strategies
not affecting all structures with a non-zero index will not terminate the tachycardia.

Another interesting remark is
that the extended approach does not find any rotors.
This result aligns with the results from \autocite{tomii2021spatial},
that states that all rotors are found around a phase defect
This could imply that only finite cores are possible.
An implication that is also strengthened by the argument that the
tissue has a finite minimal wavelength,
or the smallest curve with a non-zero phase index has a finite circumference.
And since non-conductive structures, boundaries
and phase defects are all treated in the same manner,
it is only natural to call them all finite cores in case they have a non-zero index.

% Not sure if this is relevant
This absence of rotors in the extended approach's result also
indicates that the rotors found
by using the naive approach are all due to integrating across phase defects.
This could explain the surprising results in \textcite{li2020standardizing},
where it was found that the outcome of rotor detection
depends on the threshold for identifying phase jumps.
In case only real phase jumps where present,
the results would only vary when this threshold was set close to $2\pi$.
But phase defect could be affected by this threshold
at any value between $\pi$ and $2\pi$.

% Previous research
% - Tomii\cite{tomii2021spatial}: does not describe activation patterns of phase defect boundaries
% - Arno\cite{2024simulation_feynman2D_arno}: unnecessary introduction of pivot charge + not all types of activation patterns and boundaries are described
% - Lebert\cite{2021experimental_CNN_ps_detection_lebert}: AI approaches can be improved by taking into account phase defects and replacing phase singularities with charged boundaries.

% Limitations and future prospects
% - No clinical data, but preliminary results show improved charged boundary detection in clinical tachycardia leading to improved ablation
% - Single optical mapping VF case, but this case contains the fundamental mechanisms, so our analysis can guide future fibrillation research
% - Restriction of functional and scar boundary detection using only 1 feature: phase difference. Future research should improve detection of functional and scar boundaries
% - Restriction of method to 2D meshes. Preliminary research shows applicability for 3D VT simulation meshes by taking 2D slices.
% - For the simplicity of the paper, signal smoothing, downsampling and noise effects were not extensively investigated. Future research should aim to test the robustness of charged boundary detection on these parameters

\subsection{Conclusion}

To conclude this article,
we acknowledge that the described approaches is probably too simplistic
to analyze clinical or more complex data.
Nevertheless, it should be clear
that phase defects and non-conductive tissue have a major impact
on the analysis of cardiac arrhythmia, even in this simple example.
Therefore, we invite the reader to try to analyze this example with a state-of-the-art method
and see how many pre -and post-processing steps are necessary to get the correct solution.

In case an adventurous clinician has stumbled upon this rather technical paper,
we would like to refer them to our OSF page (LINK!!!),
which contains a study protocol and necessary tools
to start a clinical study about localizing finite cores during atrial tachycardia.

\section{Data availability}

Readers who would like to reproduce our results are referred to this
GitHub repository (LINK!!!), which contains the used code and some
further explanation.

\noindent The figures, simulation data and a video of the simulation can be found on Zenodo (LINK!!!).

\printbibliography
\end{document}
